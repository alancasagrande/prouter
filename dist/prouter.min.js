!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t(require,exports,module):e.prouter=t()}(this,function(e,t,r){var n;return function(e){var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global,r={mode:"hash",root:"/"},n=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g"),a=function(){function e(){}return e._escapeString=function(e){return e.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")},e._escapeGroup=function(e){return e.replace(/([=!:$\/()])/g,"\\$1")},e.clearSlashes=function(e){return e.replace(/\/$/,"").replace(/^\//,"")},e._flags=function(e){return e.sensitive?"":"i"},e._parse=function(t){for(var r,a=[],o=0,i=0,s="";r=n.exec(t);){var h=r[0],l=r[1],u=r.index;if(s+=t.slice(i,u),i=u+h.length,l)s+=l[1];else{s&&(a.push(s),s="");var c=r[2],p=r[3],f=r[4],g=r[5],d=r[6],v=r[7],_="+"===d||"*"===d,m="?"===d||"*"===d,y=c||"/",x=f||g||(v?".*":"[^"+y+"]+?");a.push({name:p||(o++).toString(),prefix:c||"",delimiter:y,optional:m,repeat:_,pattern:e._escapeGroup(x)})}}return i<t.length&&(s+=t.substr(i)),s&&a.push(s),a},e._tokensToPathExp=function(t,r){void 0===r&&(r={});for(var n=r.strict,a=r.end!==!1,o="",i=t[t.length-1],s="string"==typeof i&&i.length&&"/"===i.charAt(i.length-1),h=0;h<t.length;h++){var l=t[h];if("string"==typeof l)o+=e._escapeString(l);else{var u=e._escapeString(l.prefix),c=l.pattern;l.repeat&&(c+="(?:"+u+c+")*"),c=l.optional?u?"(?:"+u+"("+c+"))?":"("+c+")?":u+"("+c+")",o+=c}}return n||(o=(s?o.slice(0,-2):o)+"(?:\\/(?=$))?"),o+=a?"$":n&&s?"":"(?=\\/|$)",new RegExp("^"+o,e._flags(r))},e.parseSearchString=function(e){var t={};"?"===e.charAt(0)&&(e=e.slice(1));for(var r=e.split("&"),n=0;n<r.length;n++){var a=r[n].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t},e.parsePath=function(r){var n;"function"==typeof t.URL?n=new t.URL(r,"http://example.com"):(n=document.createElement("a"),n.href="http://example.com/"+r);var a={path:e.clearSlashes(n.pathname),query:e.parseSearchString(n.search),queryString:n.search};return a},e.extractRequest=function(r,n){var a=e.parsePath(r);a.params={};var o=n.exec(a.path);if(!o)return a;for(var i=o.slice(1),s=n.keys,h=0;h<i.length;h++)void 0!==i[h]&&(a.params[s[h].name]=t.decodeURIComponent(i[h]));return a},e.stringToPathExp=function(t,r){for(var n=e._parse(t),a=e._tokensToPathExp(n,r),o=[],i=0;i<n.length;i++)"string"!=typeof n[i]&&o.push(n[i]);return a.keys=o,a},e}(),o=function(){function e(){}return e.listen=function(e){if(this._listening)throw new Error("Router already listening.");return this._listening=!0,this.config(e),"history"===this._options.mode?t.addEventListener("popstate",this._loadCurrent,!1):t.addEventListener("hashchange",this._loadCurrent,!1),this},e.config=function(e){for(var t in r)void 0!==e[t]?this._options[t]=e[t]:void 0===this._options[t]&&(this._options[t]=r[t]);return this},e.reset=function(){return t.removeEventListener("hashchange",this._loadCurrent,!1),t.removeEventListener("popstate",this._loadCurrent,!1),t.history.pushState(null,null,this._options.root),t.location.hash="#",this._handlers=[],this._listening=!1,this},e.use=function(e,t){var r;return"function"==typeof e?(t=e,r=/.*/):(e=a.clearSlashes(e),r=a.stringToPathExp(e)),this._handlers.push({path:r,activate:t}),this},e.getCurrent=function(){var e,r=this._options.mode,n=this._options.root;if("history"===r)e=a.clearSlashes(t.decodeURI(t.location.pathname+t.location.search)),e=e.replace(/\?(.*)$/,""),e="/"!==n?e.replace(n,""):e;else{var o=t.location.href.match(/#(.*)$/);e=o?o[1]:""}return e=a.clearSlashes(e)},e.navigate=function(e){e=a.clearSlashes(e);var r=this._options.mode;switch(r){case"history":this._load(e),t.history.pushState(null,null,this._options.root+e);break;case"hash":var n=this.getCurrent();e===n&&this._load(e),t.location.hash="#"+e}return this},e._loadCurrent=function(){var e=this.getCurrent();return this._load(e)},e._load=function(e){for(var t=this._obtainNodeRoutes(e),r=t.length,n=this.getCurrent(),a=0,o=0;r>o;o++){var i=t[o];i.request.old=n;var s=i.activate.call(null,i.request);if(s===!1)break;a++}return a>0},e._obtainNodeRoutes=function(e){for(var t=a.parsePath(e),r=[],n=0;n<this._handlers.length;n++){var o=this._handlers[n],i=t.path.match(o.path);if(i){var s=a.extractRequest(e,o.path),h={activate:o.activate,request:s};r.push(h)}}return r},e._handlers=[],e._options={},e._listening=!1,e}();e.Router=o}(n||(n={})),n});