!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e(require,exports,module):t.prouter=e()}(this,function(t,e,r){var n;return function(t){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global,r=/^\/+|\/+$/,n=/.*/,o=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g"),a=function(){function t(){}return t._escapeString=function(t){return t.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")},t._escapeGroup=function(t){return t.replace(/([=!:$\/()])/g,"\\$1")},t.clearSlashes=function(t){return t.replace(r,"")},t._flags=function(t){return t.sensitive?"":"i"},t._parse=function(e){for(var r,n=[],a=0,s=0,i="";r=o.exec(e);){var h=r[0],l=r[1],u=r.index;if(i+=e.slice(s,u),s=u+h.length,l)i+=l[1];else{i&&(n.push(i),i="");var p=r[2],c=r[3],f=r[4],d=r[5],v=r[6],_=r[7],g="+"===v||"*"===v,m="?"===v||"*"===v,x=p||"/",y=f||d||(_?".*":"[^"+x+"]+?");n.push({name:c||(a++).toString(),prefix:p||"",delimiter:x,optional:m,repeat:g,pattern:t._escapeGroup(y)})}}return s<e.length&&(i+=e.substr(s)),i&&n.push(i),n},t._tokensToPathExp=function(e,r){void 0===r&&(r={});for(var n=r.strict,o=r.end!==!1,a="",s=e[e.length-1],i="string"==typeof s&&s.length&&"/"===s.charAt(s.length-1),h=0;h<e.length;h++){var l=e[h];if("string"==typeof l)a+=t._escapeString(l);else{var u=t._escapeString(l.prefix),p=l.pattern;l.repeat&&(p+="(?:"+u+p+")*"),p=l.optional?u?"(?:"+u+"("+p+"))?":"("+p+")?":u+"("+p+")",a+=p}}return n||(a=(i?a.slice(0,-2):a)+"(?:\\/(?=$))?"),a+=o?"$":n&&i?"":"(?=\\/|$)",new RegExp("^"+a,t._flags(r))},t.parseQuery=function(t){var e={};"?"===t.charAt(0)&&(t=t.slice(1));for(var r=t.split("&"),n=0;n<r.length;n++){var o=r[n].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e},t.parsePath=function(r){var n;"function"==typeof e.URL?n=new e.URL(r,"http://example.com"):(n=document.createElement("a"),n.href="http://example.com/"+r);var o={path:t.clearSlashes(n.pathname),query:t.parseQuery(n.search),queryString:n.search};return o},t.stringToPathExp=function(e,r){var n=t._parse(e),o=t._tokensToPathExp(n,r);o.keys=[];for(var a=0;a<n.length;a++)"string"!=typeof n[a]&&o.keys.push(n[a]);return o},t}(),s=function(){function t(){}return t.listen=function(e){if(this._options)throw new Error("Router already listening.");this._options={};for(var r in t._DEF_OPTIONS)void 0!==e[r]?this._options[r]=e[r]:void 0===this._options[r]&&(this._options[r]=t._DEF_OPTIONS[r]);switch(this._options.mode){case"history":addEventListener("popstate",this._loadCurrent,!1);break;case"hash":addEventListener("hashchange",this._loadCurrent,!1);break;default:throw new Error("Invalid mode '"+this._options.mode+"'. Valid modes are: 'history', 'hash'.")}var n=!1;return this._options.silent||(n=this._loadCurrent()),n},t.stop=function(){return"history"===this._options.mode?(removeEventListener("popstate",this._loadCurrent,!1),history.pushState(null,null,this._options.root)):(removeEventListener("hashchange",this._loadCurrent,!1),location.hash="#"),this._handlers=[],this._loadedPath=null,this._options=null,this},t.getCurrent=function(){var t;if("history"===this._options.mode){var e=decodeURI(location.pathname+location.search);t=a.clearSlashes(e),t="/"===this._options.root?t:t.slice(this._options.root.length)}else{var r=location.href.match(/#(.*)$/);t=r?r[1]:""}return t=a.clearSlashes(t)},t.use=function(t,e){if(e instanceof i||t instanceof i){var r;t instanceof i?e=t:r=a.clearSlashes(t),this._handlers=this._extractHandlers(r,e)}else{var o;"function"==typeof t?(e=t,o=n):(t=a.clearSlashes(t),o=a.stringToPathExp(t)),this._handlers.push({pathExp:o,activate:e})}return this},t.navigate=function(t){if(!this._options)throw new Error("It is required to call the 'listen' function before navigating.");switch(t=a.clearSlashes(t),this._options.mode){case"history":history.pushState(null,null,this._options.root+t);break;case"hash":location.hash="#"+t}return this._load(t)},t._loadCurrent=function(){var t=this.getCurrent();return t===this._loadedPath?!1:this._load(t)},t._load=function(t){for(var e=this._obtainRequestProcessors(t),r=0,n=0;n<e.length;n++){var o=e[n];o.request.oldPath=this._loadedPath;var a=o.activate.call(null,o.request);if(a===!1)break;r++}var s=r>0;return this._loadedPath=t,s},t._extractHandlers=function(t,e,r){void 0===r&&(r=[]);for(var o=e._handlers,s=0;s<o.length;s++){var i=o[s],h=void 0,l=void 0;"function"==typeof i.path?l=i.path:(l=i.activate,h=a.clearSlashes(i.path));var u=void 0;if(void 0===t||void 0===h)u=void 0===t&&void 0===h?n:a.stringToPathExp(void 0===t?h:t);else{var p=t+"/"+h;u=a.stringToPathExp(p)}r.push({pathExp:u,activate:l})}return r},t._obtainRequestProcessors=function(t){for(var e=a.parsePath(t),r=[],n=0;n<this._handlers.length;n++){var o=this._handlers[n],s=o.pathExp.test(e.path);if(s){var i=this._extractRequest(t,o.pathExp),h={activate:o.activate,request:i};r.push(h)}}return r},t._extractRequest=function(t,e){var r=a.parsePath(t);r.params={};var n=e?e.exec(r.path):null;if(!n)return r;for(var o=n.slice(1),s=e.keys,i=0;i<o.length;i++)void 0!==o[i]&&(r.params[s[i].name]=decodeURIComponent(o[i]));return r},t._DEF_OPTIONS={mode:"hash",root:"/",silent:!1},t._handlers=[],t}();t.Router=s;var i=function(){function t(){this._handlers=[]}return t.prototype.use=function(t,e){return this._handlers.push({path:t,activate:e}),this},t}();t.RouteGroup=i}(n||(n={})),n});