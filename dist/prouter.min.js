!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t(require,exports,module):e.prouter=t()}(this,function(e,t,r){var n;return function(e){var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global,r=/^\/+|\/+$/,n=/.*/,a={hashChange:!0,usePushState:!1,root:"/",silent:!1},s=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g"),i=function(){function e(){}return e.parseQuery=function(e){var t={};"?"===e.charAt(0)&&(e=e.slice(1));for(var r=e.split("&"),n=0;n<r.length;n++){var a=r[n].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t},e.parsePath=function(r){var n;"function"==typeof t.URL?n=new t.URL(r,"http://example.com"):(n=document.createElement("a"),n.href="http://example.com/"+r);var a={path:e.clearSlashes(n.pathname),query:e.parseQuery(n.search),queryString:n.search};return a},e.ensureSlashes=function(e){return"/"===e?e:("/"!==e.charAt(0)&&(e="/"+e),"/"!==e.charAt(e.length-1)&&(e+="/"),e)},e.escapeString=function(e){return e.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")},e._escapeGroup=function(e){return e.replace(/([=!:$\/()])/g,"\\$1")},e.clearSlashes=function(e){return e.replace(r,"")},e._flags=function(e){return e.sensitive?"":"i"},e._parse=function(t){for(var r,n=[],a=0,i=0,o="";r=s.exec(t);){var h=r[0],u=r[1],l=r.index;if(o+=t.slice(i,l),i=l+h.length,u)o+=u[1];else{o&&(n.push(o),o="");var c=r[2],p=r[3],f=r[4],d=r[5],v=r[6],g=r[7],_="+"===v||"*"===v,x="?"===v||"*"===v,y=c||"/",m=f||d||(g?".*":"[^"+y+"]+?");n.push({name:p||(a++).toString(),prefix:c||"",delimiter:y,optional:x,repeat:_,pattern:e._escapeGroup(m)})}}return i<t.length&&(o+=t.substr(i)),o&&n.push(o),n},e._tokensToPathExp=function(t,r){void 0===r&&(r={});for(var n=r.strict,a=r.end!==!1,s="",i=t[t.length-1],o="string"==typeof i&&i.length&&"/"===i.charAt(i.length-1),h=0;h<t.length;h++){var u=t[h];if("string"==typeof u)s+=e.escapeString(u);else{var l=e.escapeString(u.prefix),c=u.pattern;u.repeat&&(c+="(?:"+l+c+")*"),c=u.optional?l?"(?:"+l+"("+c+"))?":"("+c+")?":l+"("+c+")",s+=c}}return n||(s=(o?s.slice(0,-2):s)+"(?:\\/(?=$))?"),s+=a?"$":n&&o?"":"(?=\\/|$)",new RegExp("^"+s,e._flags(r))},e.stringToPathExp=function(t,r){var n=e._parse(t),a=e._tokensToPathExp(n,r);a.keys=[];for(var s=0;s<n.length;s++)"string"!=typeof n[s]&&a.keys.push(n[s]);return a},e}(),o=function(){function e(){}return e.listen=function(e){if(void 0===e&&(e={}),void 0!==this._root&&null!==this._root)throw new Error("Router already listening.");for(var r in a)void 0===e[r]&&(e[r]=a[r]);this._wantsHashChange=e.hashChange,this._usePushState=e.usePushState&&!(!t.history||!t.history.pushState),this._root=i.ensureSlashes(e.root),this._handlers=[],this._usePushState?addEventListener("popstate",this.heedCurrent,!1):this._wantsHashChange&&addEventListener("hashchange",this.heedCurrent,!1);var n=!1;return e.silent||(n=this.heedCurrent()),n},e.stop=function(){removeEventListener("popstate",this.heedCurrent,!1),removeEventListener("hashchange",this.heedCurrent,!1);for(var e in this)this.hasOwnProperty(e)&&"function"!=typeof this[e]&&(this[e]=null);return this},e.getCurrent=function(){var e;if(this._usePushState||!this._wantsHashChange)e=decodeURI(location.pathname+location.search),e=e.slice(this._root.length);else{var t=location.href.match(/#(.*)$/);e=t?t[1]:""}return e=i.clearSlashes(e)},e.use=function(e,t){if(t instanceof h||e instanceof h){var r;e instanceof h?t=e:r=i.clearSlashes(e),this._handlers=this._extractHandlers(r,t,this._handlers)}else{var a;"function"==typeof e?(t=e,a=n):(e=i.clearSlashes(e),a=i.stringToPathExp(e)),this._handlers.push({pathExp:a,activate:t})}return this},e.navigate=function(e){if(void 0===this._root||null===this._root)throw new Error("It is required to call the 'listen' function before navigating.");if(e=i.clearSlashes(e),this._usePushState)history.pushState(null,null,this._root+e);else{if(!this._wantsHashChange)return location.assign(this._root+e),!0;location.hash="#"+e}return this.load(e)},e.heedCurrent=function(){var e=this.getCurrent();return e===this._loadedPath?!1:this.load(e)},e.load=function(e){for(var t=this._obtainRequestProcessors(e),r=0,n=0;n<t.length;n++){var a=t[n];a.request.oldPath=this._loadedPath;var s=a.activate.call(null,a.request);if(s===!1)break;r++}var i=r>0;return this._loadedPath=e,i},e._extractHandlers=function(e,t,r){void 0===r&&(r=[]);for(var a=t._handlers,s=0;s<a.length;s++){var o=a[s],h=void 0,u=void 0;"function"==typeof o.path?u=o.path:(u=o.activate,h=i.clearSlashes(o.path));var l=void 0;if(void 0===e||void 0===h)l=void 0===e&&void 0===h?n:i.stringToPathExp(void 0===e?h:e);else{var c=e+"/"+h;l=i.stringToPathExp(c)}r.push({pathExp:l,activate:u})}return r},e._obtainRequestProcessors=function(e){for(var t=i.parsePath(e),r=[],n=0;n<this._handlers.length;n++){var a=this._handlers[n],s=a.pathExp.test(t.path);if(s){var o=this._extractRequest(e,a.pathExp),h={activate:a.activate,request:o};r.push(h)}}return r},e._extractRequest=function(e,t){var r=i.parsePath(e);r.params={};for(var n=t.exec(r.path),a=n.slice(1),s=t.keys,o=0;o<a.length;o++)void 0!==a[o]&&(r.params[s[o].name]=decodeURIComponent(a[o]));return r},e}();e.Router=o,o.heedCurrent=o.heedCurrent.bind(o);var h=function(){function e(){this._handlers=[]}return e.prototype.use=function(e,t){return this._handlers.push({path:e,activate:t}),this},e}();e.RouteGroup=h}(n||(n={})),n});