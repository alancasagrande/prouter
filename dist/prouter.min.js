!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e(require,exports,module):t.prouter=e()}(this,function(t,e,r){var n;return function(t){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global,r={mode:"hash",root:"/"},n=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g"),a=/.*/,o=function(){function t(){}return t._escapeString=function(t){return t.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")},t._escapeGroup=function(t){return t.replace(/([=!:$\/()])/g,"\\$1")},t.clearSlashes=function(t){return t.replace(/\/$/,"").replace(/^\//,"")},t._flags=function(t){return t.sensitive?"":"i"},t._parse=function(e){for(var r,a=[],o=0,s=0,i="";r=n.exec(e);){var h=r[0],l=r[1],p=r.index;if(i+=e.slice(s,p),s=p+h.length,l)i+=l[1];else{i&&(a.push(i),i="");var c=r[2],u=r[3],f=r[4],d=r[5],v=r[6],g=r[7],_="+"===v||"*"===v,m="?"===v||"*"===v,y=c||"/",x=f||d||(g?".*":"[^"+y+"]+?");a.push({name:u||(o++).toString(),prefix:c||"",delimiter:y,optional:m,repeat:_,pattern:t._escapeGroup(x)})}}return s<e.length&&(i+=e.substr(s)),i&&a.push(i),a},t._tokensToPathExp=function(e,r){void 0===r&&(r={});for(var n=r.strict,a=r.end!==!1,o="",s=e[e.length-1],i="string"==typeof s&&s.length&&"/"===s.charAt(s.length-1),h=0;h<e.length;h++){var l=e[h];if("string"==typeof l)o+=t._escapeString(l);else{var p=t._escapeString(l.prefix),c=l.pattern;l.repeat&&(c+="(?:"+p+c+")*"),c=l.optional?p?"(?:"+p+"("+c+"))?":"("+c+")?":p+"("+c+")",o+=c}}return n||(o=(i?o.slice(0,-2):o)+"(?:\\/(?=$))?"),o+=a?"$":n&&i?"":"(?=\\/|$)",new RegExp("^"+o,t._flags(r))},t.parseSearchString=function(t){var e={};"?"===t.charAt(0)&&(t=t.slice(1));for(var r=t.split("&"),n=0;n<r.length;n++){var a=r[n].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e},t.parsePath=function(r){var n;"function"==typeof e.URL?n=new e.URL(r,"http://example.com"):(n=document.createElement("a"),n.href="http://example.com/"+r);var a={path:t.clearSlashes(n.pathname),query:t.parseSearchString(n.search),queryString:n.search};return a},t.stringToPathExp=function(e,r){var n=t._parse(e),a=t._tokensToPathExp(n,r);a.keys=[];for(var o=0;o<n.length;o++)"string"!=typeof n[o]&&a.keys.push(n[o]);return a},t}(),s=function(){function t(){}return t.listen=function(t){if(this._listening)throw new Error("Router already listening.");switch(this._listening=!0,this.config(t),this._options.mode){case"history":addEventListener("popstate",this._loadCurrent,!1);break;case"hash":addEventListener("hashchange",this._loadCurrent,!1);break;default:throw new Error("Invalid mode '"+this._options.mode+"'. Valid modes are: 'history', 'hash'.")}return this},t.config=function(t){for(var e in r)void 0!==t[e]?this._options[e]=t[e]:void 0===this._options[e]&&(this._options[e]=r[e]);return this},t.stop=function(){return"history"===this._options.mode?(removeEventListener("popstate",this._loadCurrent,!1),history.pushState(null,null,this._options.root)):(removeEventListener("hashchange",this._loadCurrent,!1),location.hash="#"),this._handlers=[],this._listening=!1,this},t.getCurrent=function(){var t;if("history"===this._options.mode){var e=this._options.root;t=o.clearSlashes(decodeURI(location.pathname+location.search)),t=t.replace(/\?(.*)$/,""),t="/"!==e?t.replace(e,""):t}else{var r=location.href.match(/#(.*)$/);t=r?r[1]:""}return t=o.clearSlashes(t)},t.navigate=function(t){switch(t=o.clearSlashes(t),this._options.mode){case"history":this._load(t),history.pushState(null,null,this._options.root+t);break;case"hash":var e=this.getCurrent();t===e&&this._load(t),location.hash="#"+t}},t.use=function(t,e){if(e instanceof i||t instanceof i){var r;t instanceof i?e=t:r=o.clearSlashes(t),this._handlers=this._obtainHandlers(r,e)}else{var n;"function"==typeof t?(e=t,n=a):(t=o.clearSlashes(t),n=o.stringToPathExp(t)),this._handlers.push({pathExp:n,activate:e})}return this},t._loadCurrent=function(){var t=this.getCurrent();return this._load(t)},t._load=function(t){for(var e=this._obtainRequestProcessors(t),r=this.getCurrent(),n=0,a=0;a<e.length;a++){var o=e[a];o.request.old=r;var s=o.activate.call(null,o.request);if(s===!1)break;n++}return n>0},t._obtainHandlers=function(t,e,r){void 0===r&&(r=[]);for(var n=e._handlers,s=0;s<n.length;s++){var i=n[s],h=void 0,l=void 0;"function"==typeof i.path?l=i.path:(l=i.activate,h=o.clearSlashes(i.path));var p=void 0;if(void 0===t||void 0===h)p=void 0===t&&void 0===h?a:o.stringToPathExp(void 0===t?h:t);else{var c=t+"/"+h;p=o.stringToPathExp(c)}r.push({pathExp:p,activate:l})}return r},t._obtainRequest=function(t,e){var r=o.parsePath(t);r.params={};var n=e?e.exec(r.path):null;if(!n)return r;for(var a=n.slice(1),s=e.keys,i=0;i<a.length;i++)void 0!==a[i]&&(r.params[s[i].name]=decodeURIComponent(a[i]));return r},t._obtainRequestProcessors=function(t){for(var e=o.parsePath(t),r=[],n=0;n<this._handlers.length;n++){var a=this._handlers[n],s=a.pathExp.test(e.path);if(s){var i=this._obtainRequest(t,a.pathExp),h={activate:a.activate,request:i};r.push(h)}}return r},t._handlers=[],t._options={},t._listening=!1,t}();t.Router=s;var i=function(){function t(){this._handlers=[]}return t.prototype.use=function(t,e){this._handlers.push({path:t,activate:e})},t}();t.RouteGroup=i}(n||(n={})),n});