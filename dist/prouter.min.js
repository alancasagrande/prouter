!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e(require,exports,module):t.prouter=e()}(this,function(t,e,r){var n;return function(t){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global,r=/^\/+|\/+$/,n=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g"),a=/.*/,s={hashChange:!0,usePushState:!1,root:"/",silent:!1},i=function(){function t(){}return t.parseQuery=function(t){var e={};"?"===t.charAt(0)&&(t=t.slice(1));for(var r=t.split("&"),n=0;n<r.length;n++){var a=r[n].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e},t.parsePath=function(r){var n;"function"==typeof e.URL?n=new e.URL(r,"http://example.com"):(n=document.createElement("a"),n.href="http://example.com/"+r);var a={path:t.clearSlashes(n.pathname),query:t.parseQuery(n.search),queryString:n.search};return a},t.ensureSlashes=function(t){return"/"===t?t:("/"!==t.charAt(0)&&(t="/"+t),"/"!==t.charAt(t.length-1)&&(t+="/"),t)},t.escapeString=function(t){return t.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")},t._escapeGroup=function(t){return t.replace(/([=!:$\/()])/g,"\\$1")},t.clearSlashes=function(t){return t.replace(r,"")},t._flags=function(t){return t.sensitive?"":"i"},t._parse=function(e){for(var r,a=[],s=0,i=0,o="";r=n.exec(e);){var h=r[0],u=r[1],l=r.index;if(o+=e.slice(i,l),i=l+h.length,u)o+=u[1];else{o&&(a.push(o),o="");var c=r[2],p=r[3],f=r[4],d=r[5],v=r[6],g=r[7],_="+"===v||"*"===v,x="?"===v||"*"===v,y=c||"/",m=f||d||(g?".*":"[^"+y+"]+?");a.push({name:p||(s++).toString(),prefix:c||"",delimiter:y,optional:x,repeat:_,pattern:t._escapeGroup(m)})}}return i<e.length&&(o+=e.substr(i)),o&&a.push(o),a},t._tokensToPathExp=function(e,r){void 0===r&&(r={});for(var n=r.strict,a=r.end!==!1,s="",i=e[e.length-1],o="string"==typeof i&&i.length&&"/"===i.charAt(i.length-1),h=0;h<e.length;h++){var u=e[h];if("string"==typeof u)s+=t.escapeString(u);else{var l=t.escapeString(u.prefix),c=u.pattern;u.repeat&&(c+="(?:"+l+c+")*"),c=u.optional?l?"(?:"+l+"("+c+"))?":"("+c+")?":l+"("+c+")",s+=c}}return n||(s=(o?s.slice(0,-2):s)+"(?:\\/(?=$))?"),s+=a?"$":n&&o?"":"(?=\\/|$)",new RegExp("^"+s,t._flags(r))},t.stringToPathExp=function(e,r){var n=t._parse(e),a=t._tokensToPathExp(n,r);a.keys=[];for(var s=0;s<n.length;s++)"string"!=typeof n[s]&&a.keys.push(n[s]);return a},t}(),o=function(){function t(){}return t.listen=function(t){if(void 0===t&&(t={}),void 0!==this._root&&null!==this._root)throw new Error("Router already listening.");for(var r in s)void 0===t[r]&&(t[r]=s[r]);return this._wantsHashChange=t.hashChange,this._usePushState=t.usePushState&&!(!e.history||!e.history.pushState),this._root=i.ensureSlashes(t.root),this._handlers=[],this._usePushState?addEventListener("popstate",this.heedCurrent,!1):this._wantsHashChange&&addEventListener("hashchange",this.heedCurrent,!1),t.silent||this.heedCurrent(),this},t.stop=function(){removeEventListener("popstate",this.heedCurrent,!1),removeEventListener("hashchange",this.heedCurrent,!1);for(var t in this)this.hasOwnProperty(t)&&"function"!=typeof this[t]&&(this[t]=null);return this},t.getCurrent=function(){var t;if(this._usePushState||!this._wantsHashChange)t=decodeURI(location.pathname+location.search),t=t.slice(this._root.length);else{var e=location.href.match(/#(.*)$/);t=e?e[1]:""}return t=i.clearSlashes(t)},t.use=function(t,e){if(e instanceof h||t instanceof h){var r;t instanceof h?e=t:r=i.clearSlashes(t),this._handlers=this._extractHandlers(r,e,this._handlers)}else{var n;"function"==typeof t?(e=t,n=a):(t=i.clearSlashes(t),n=i.stringToPathExp(t)),this._handlers.push({pathExp:n,activate:e})}return this},t.navigate=function(t){if(void 0===this._root||null===this._root)throw new Error("It is required to call the 'listen' function before navigating.");if(t=i.clearSlashes(t),this._usePushState)history.pushState(null,null,this._root+t);else{if(!this._wantsHashChange)return location.assign(this._root+t),!0;location.hash="#"+t}return this.load(t)},t.heedCurrent=function(){var t=this.getCurrent();return t===this._loadedPath?this:this.load(t)},t.load=function(e){function r(){if(!(a>=n.length)){var e=n[a];a++,e.request.oldPath=t._loadedPath;var s=e.activate.call(null,e.request,r);s===!0&&r()}}var n=this._obtainRequestProcessors(e);if(n.length){var a=0;r()}return this._loadedPath=e,this},t._extractHandlers=function(t,e,r){void 0===r&&(r=[]);for(var n=e._handlers,s=0;s<n.length;s++){var o=n[s],h=void 0,u=void 0;"function"==typeof o.path?u=o.path:(u=o.activate,h=i.clearSlashes(o.path));var l=void 0;if(void 0===t||void 0===h)l=void 0===t&&void 0===h?a:i.stringToPathExp(void 0===t?h:t);else{var c=t+"/"+h;l=i.stringToPathExp(c)}r.push({pathExp:l,activate:u})}return r},t._obtainRequestProcessors=function(t){for(var e=i.parsePath(t),r=[],n=0;n<this._handlers.length;n++){var a=this._handlers[n],s=a.pathExp.test(e.path);if(s){var o=this._extractRequest(t,a.pathExp);r.push({activate:a.activate,request:o})}}return r},t._extractRequest=function(t,e){var r=i.parsePath(t);r.params={};for(var n=e.exec(r.path),a=n.slice(1),s=e.keys,o=0;o<a.length;o++)void 0!==a[o]&&(r.params[s[o].name]=decodeURIComponent(a[o]));return r},t}();t.Router=o,o.heedCurrent=o.heedCurrent.bind(o);var h=function(){function t(){this._handlers=[]}return t.prototype.use=function(t,e){return this._handlers.push({path:t,activate:e}),this},t}();t.RouteGroup=h}(n||(n={})),n});